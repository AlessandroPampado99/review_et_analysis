input:
  excel_path: "C:\\Users\\aless\\Desktop\\PhD_Pisa\\2025_01_10\\review_et_analysis\\input\\input_dataset.xlsx"
  sheet: "input_dataset"
  header: 0
  exclude_last_cols: 3
  flatten_columns: true
  flatten_sep: " | "
  flatten_lower: false
  flatten_strip: true
  cache_parquet: false         # true just if you want cache
  cache_path: "C:\\path\\to\\cache\\data.parquet"

pipeline:
  - step: drop_columns
    params:
      names: ["id_to_remove", "notes"]

  - step: coerce_numeric
    params:
      columns: ["CAPEX", "OPEX", "lifetime", "efficiency"]

  - step: filter_rows
    params:
      query: "CAPEX > 0"
      
  - step: assign_colors_by_technology
    params:
      technology_col: "Technology name"
      cmap_name: "tab20"
      seed: 42
      shuffle: false

  - step: stats_by_technology
    params:
      technology_col: "Technology name"
      columns: ["CAPEX", "OPEX", "lifetime", "efficiency"]
      metrics: ["mean", "median", "min", "max", "count", "std"]
      output_dir: "C:\\Users\\aless\\Desktop\\PhD_Pisa\\2025_01_10\\review_et_analysis\\output\\stats"

  # bar plot for CAPEX
  - step: plot_bar_by_technology
    params:
      stats_source_col: "CAPEX"
      value_col: "mean"
      error_col: "std"
      count_col: "count"
      # top_n: 20
      out_dir: "C:\\Users\\aless\\Desktop\\PhD_Pisa\\2025_01_10\\review_et_analysis\\output\\plots\\capex"

  # bar plot per OPEX
  - step: plot_bar_by_technology
    params:
      stats_source_col: "efficiency"
      value_col: "mean"
      error_col: "std"
      count_col: "count"
      top_n: 30
      out_dir: "C:\\Users\\aless\\Desktop\\PhD_Pisa\\2025_01_10\\review_et_analysis\\output\\plots\\efficiency"

output:
  save_csv: true
  csv_path: "C:\\Users\\aless\\Desktop\\PhD_Pisa\\2025_01_10\\review_et_analysis\\output\\final_output.csv"
